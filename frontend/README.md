# AI 角色扮演（Vue 3 + Vite）

一个统一语音交互的 AI 角色扮演网页，覆盖 P0~P2：
- **P0**：语音/文字聊天（角色扮演）、聊天记录导出与（登录后）保存
- **P1**：身份认证、会员/订单页（示例）
- **P2**：角色库、社交导出（文件导出）、知识面板（网页入库/检索/上下文注入）、多模态（语音 + URL 知识）、文件占位

## 运行

```bash
pnpm i # 或 npm i / yarn
pnpm dev
```

开发模式默认直连本地后端：
- LLM Chat（流式）`/api/chat/stream`（端口见 .env.development）
- ASR 语音识别 `/asr`
- TTS 语音合成 `/synthesize`
- 核心/会员/聊天记录 `/api/*` + `/chat/api/*` + `/web/*`

> 若跨域，请在后端开启 CORS 或通过 Nginx 反代成同域。

## 功能要点

- **角色扮演**：侧栏搜索选择角色（苏格拉底、哈利·波特、Java 面试官等）。系统提示内统一带安全与一致性约束；结尾自动抽取 `[DEEP_QUESTIONS]`，在输入框上方展示为可点选 Chip。
- **语音聊天**：内置 WAV 录音器（16kHz PCM），上传到 ASR 得文字，随后喂给 LLM；AI 回复可选自动 TTS 播放，支持风格与情感强度。
- **一致性**：以“短期记忆摘要 + 上下文注入”的方式维持对话一致性；右侧知识面板支持网页入库检索，并把片段注入系统消息。
- **安全性**：系统提示中内置安全边界；角色仅在安全范围内扮演。
- **聊天记录**：游客可导出 JSON；已登录可调用后端保存（以 `data:` URL 占位）。
- **会员**：示例化的会员与订单页。

## 配色

全站采用**莫兰迪色系**：雾蓝、青灰、沙褐为主，低饱和，柔和细腻。参见 `src/styles/theme.css`。

## 与后端的对接

- Chat：`POST /api/chat` 与 `POST /api/chat/stream`（ModelScope/OpenAI 兼容）。
- ASR：`POST /asr` 返回转写文本。
- TTS：`POST /synthesize` 返回 WAV 音频。
- 用户/会员/订单/知识库/聊天记录：见 `/api/*`、`/web/*`、`/chat/api/*`。

你可以在 `.env.*` 中配置后端地址或改为同域反代。