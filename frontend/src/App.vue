<template>
  <div class="app-shell">
    <aside class="sidebar">
      <RoleSearch @select="onSelectRole" />
      <hr class="sep" />
      <router-link class="role-card" to="/chat">
        <div class="role">ğŸ’¬</div>
        <div>
          <div><b>å¯¹è¯</b></div>
          <small class="hint">è¯­éŸ³/æ–‡å­—ï¼Œè§’è‰²æ‰®æ¼”</small>
        </div>
      </router-link>
      <router-link class="role-card" to="/membership">
        <div class="role">â­</div>
        <div>
          <div><b>ä¼šå‘˜</b></div>
          <small class="hint">æŸ¥çœ‹æƒç›Šä¸è®¢å•</small>
        </div>
      </router-link>
      <router-link class="role-card" to="/profile">
        <div class="role">ğŸ‘¤</div>
        <div>
          <div><b>è´¦æˆ·</b></div>
          <small class="hint">ç™»å½•/æ³¨å†Œ/èµ„æ–™</small>
        </div>
      </router-link>
    </aside>

    <header class="header">
      <div class="row">
        <span class="badge">{{ appName }}</span>
        <span class="faint">è«å…°è¿ªé…è‰² Â· ç»Ÿä¸€è¯­éŸ³äº¤äº’å¹³å°</span>
      </div>
      <div class="row">
        <router-link class="btn ghost" to="/role">è§’è‰²åº“</router-link>
        <router-link class="btn ghost" to="/chat">èŠå¤©</router-link>
        <router-link class="btn ghost" to="/membership">ä¼šå‘˜</router-link>
      </div>
    </header>

    <main class="main">
      <router-view />
    </main>

    <aside class="right">
      <KnowledgePanel />
    </aside>
  </div>
</template>

<script setup>
import RoleSearch from './components/RoleSearch.vue'
import KnowledgePanel from './components/KnowledgePanel.vue'
import { useRouter } from 'vue-router'
import { useChatStore } from './store/chat'
const router = useRouter()
const appName = import.meta.env.VITE_APP_NAME || 'AI è§’è‰²æ‰®æ¼”'
const chat = useChatStore()

function onSelectRole(role){
  chat.setCurrentRole(role)
  router.push('/chat')
}
</script>